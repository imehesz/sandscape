var lastReceived=0;function initLobby(a){$("#writemessage").keypress(function(b){if(b.which==13){$("#sendbtn").click()}});setInterval(function(){updateMessages(a)},5000);$(".join").click(function(b){$("#game").val($(this).children(".hGameId").val());$("#maxDecksJoin").val($(this).children(".hGameDM").val());$("#joindlg").modal()});$(".spectate").click(function(b){$("#specgame").val($(this).children(".hGameId").val());$("#spectatedlg").modal()})}function sendMessage(a){var b=$("#writemessage").val();if(b.length>0){$.ajax({type:"POST",url:a,data:{chatmessage:b},dataType:"json",success:function(c){if(c.success){$("#lobbychat").append("<li><span><strong>"+c.name+"</strong>&nbsp;["+c.date+"]:</span><br />"+b+"</li>");lastReceived=c.id;updateMessageScroll()}}});$("#writemessage").val("")}}function updateMessages(a){$.ajax({type:"POST",url:a,data:{lastupdate:lastReceived},dataType:"json",success:function(b){if(b.has){$.each(b.messages,function(){$("#lobbychat").append("<li><span><strong>"+this.name+"</strong>&nbsp;["+this.date+"]:</span><br />"+this.message+"</li>")});lastReceived=b.last;updateMessageScroll()}}})}function updateMessageScroll(){$("#lobbychat").scrollTop($("#lobbychat")[0].scrollHeight)}function limitDeckSelection(b){var a=parseInt($("#maxDecks").val(),10),c=$(".marker").filter(":checked").length;if($(b).attr("disabled")!=""){if(c==a){$(b).attr("disabled","")}}else{if(c!=a){$(b).attr("disabled","disabled")}}};